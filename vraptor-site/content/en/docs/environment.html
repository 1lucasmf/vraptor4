---
title: Environment
---

# Working with environments

Environment is a VRaptor's feature that allow you to define different components and settings based on the environment like: production, testing, development, and so on.

You can, for example, deactivate the e-mail service in the development environment and enable only in production.

## How to configure

Environment is searched using the following order: in the system environment, in the JVM propertues, and by the last option, in the `web.xml`. If the environment name isn't found in neither locations, the `DEVELOPMENT` will used.

To configure the environment in your operational system, you need to add a environment variable called `VRAPTOR_ENV`.

Windows example:

~~~ 
set VRAPTOR_ENV=PRODUCTION
~~~ 

Unix example:

~~~ 
export VRAPTOR_ENV=PRODUCTION
~~~ 

The second option is configure a JVM property. For this, you only need to start your Application Servlet or Servlet Container adding the parameter as:

~~~
-Dbr.com.caelum.vraptor.environment=PRODUCTION
~~~

And if you prefer to configure the environment name in your application, you only need to add this lines in yor `web.xml`:

~~~ 
#!xml
<context-param>
	<param-name>br.com.caelum.vraptor.environment</param-name>
	<param-value>PRODUCTION</param-value>
</context-param>
~~~ 

## Setting an environment properties

You only need to create a properties file with the name of your environment in your classpath. As example, to set the properties for `PRODUCTION` environment you only need to create a file called `production.properties` like this:

~~~ 
#!properties
test_environment=false
email=production.mail@mail.com
~~~ 

Tip: if you have a common properties for other environments you can create a file called `environment.properties` with these common properties. So VRaptor will ask for properties first in the environment file, and if not found, will ask in the `environment.properties` file.

## Getting environment properties in your code

~~~ 
#!java
@Controller
public class MyController {

	private final Environment environment;

	private final MailSender sender;

	/**
	 * @deprecated CDI eyes only
	 */
	protected MyController(){
		this(null, null);
	}

	@Inject
	public MyController(Environment environment, MailSender sender) {
		this.environment = environment;
		this.sender = sender;
	}

	public void sendMail(String email) {
		if(environment.isDevelopment()) {
			sender.sendMailTo(environment.get("email"));
			return;
		}
		sender.sendMailTo(email);
	}
}
~~~ 

## Getting environment properties in your JSP

~~~ 
#!xml
<c:if test="${environment.isTest()}">
    <p>You are now in the test environment. Your actions here will not affect the system.</p>
</c:if>

Send an e-mail to: ${environment.get('email')}
~~~ 
        
## Accessing configuration files according to the environment

If you need to access a file in a different setting for your libraries according to your environment, you can also use the environemnt. Just put, for example, your `hibernate.cfg.xml` under directories located with the name of your environment: *development* and *production* (for example). `Environment.getResource (...)` returns the resource according to your current environment:

~~~ 
#!java
cfg = new AnnotationConfiguration();
cfg.configure(environment.getResource("/hibernate.cfg.xml"));
~~~ 

To keep compatibility with applications that don't not environment, if the file isn't found in the directory with the name of the environment, it will be loaded from classpath.

## Injecting the value of your configuration programmatically

You can also inject your settings programmatically using `@Property` annotation, like:

~~~ 
#!java
@Controller
public class MyController {

	@Inject
	@Property("email")
	private String email;

	public void sendMail(String email) {
		sender.sendMailTo(email);
	}
}
~~~ 

If your environment is `DEVELOPMENT`, the value for key `email` will be loaded using `development.properties`. And if your environment is `PRODUCTION` the value will be loaded from `production.properties`. This feature allow you to keep away from conditional statements like: `if (environment.isDevelopment ()) {...}` in your code.

And if the field name is the same from the key, you can use only the `@Property` annotation without define a value, like this:

~~~ 
#!java      
@Controller
public class MyController {

	@Inject
	@Property
	private String email;

	public void sendMail(String email) {
		sender.sendMailTo(email);
	}
}
~~~ 

You can also set a default value for this property:

~~~
#!java
@Inject
@Property(defaultValue = "config.properties")
private String fileName;
~~~
